<%= javascript_include_tag 'openseadragon/openseadragon.min' %>

<div id="img_viewer_modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="<%= object_title.gsub(/\'/,'') %>" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel"><%= object_title.gsub(/\'/,'') %></h4>
      </div>
      <div class="modal-body" id="img_viewer_osd"></div>
      <div class="modal-footer"></div>
    </div>
  </div>
</div>

<script type="text/javascript">
    $('#img_viewer_link').click(function() {
        $('#img_viewer_modal').modal();
        $("#img_viewer_osd").css("height", $(window).height() - 60);
        OpenSeadragon({
            id: "img_viewer_osd",
            prefixUrl: "/assets/openseadragon/",
            tileSources: ['<%= iiif_info_path(:identifier => image_pid) %>'],
            autoHideControls: false,
            immediateRender: navigator.userAgent.match(/mobile/i),
            showNavigator: true,
            navigatorPosition: 'TOP_RIGHT',
            showRotationControl: true,
            navigationControlAnchor: OpenSeadragon.ControlAnchor.BOTTOM_RIGHT,
            showFullPageControl: false
        });
        return false;
    });
    $('#img_viewer_modal').on('hidden.bs.modal', function (e) {
        $("#img_viewer_osd").find('.openseadragon-container').remove();
    });
</script>
